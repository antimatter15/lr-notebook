{% extends "layout.html" %}
{% from "macros/log.html" import render_months, render_days, render_day_entry %}
{% from "macros/log.html" import link_to_day, link_to_hidden_day %}
{% from "macros/projects.html" import render_my_categories %}
{% from "macros/project-entry.html" import render_attachments, render_entry_footer %}


{% block title %}{{ this.title }}{% endblock %}
{% block body %}

<iframe width="0" height="0" border="0" name="frame" style="border-style: none;"></iframe>

{% for year in site.query('/log') %}
<div class="calendar row">
  <div class="eight columns">
    <a {% if this.parent.parent == year %}class="active"{% endif %} href="{{ year|url }}">{{ year.label }}
    </a>{{ render_months(year.children, this.parent) }}</div>
</div>
{% endfor %}

<div class="row">
  <div class="ten columns">
   <span class="days"><a href="{{this.parent.parent|url}}">{{this.parent.parent.label}}</a>-<a href="{{this.parent|url}}">{{this.parent.label}}</a></span>
   &nbsp;
    {% for entry in site.query(this.parent.path).include_undiscoverable(true) %}
      {% if entry.is_hidden %}
        {{ link_to_hidden_day(entry) }}
      {% else %}
       {{ link_to_day(entry, active=this) }}
      {% endif %}
    {% endfor %}
  </div>
</div>

<h5>Notebook entry for {{this.parent.parent.label}}-{{this.parent.label}}-{{this.title}}</h5>


{% if this.body %}

<h1 style="text-decoration:underline;">Contents for today should be moved into subfolders.</h1>

{{ render_day_entry(this) }}
{{ render_attachments(this) }}

{% else %}

{% for entry in this.children %}
  <form style="display:inline;" target="frame" action="/admin/api/browsefs" method="post">
    <input type="hidden" name="path" value="{{entry.path}}">
    <input type="image" style="margin-top:1rem;" src={{ '/static/images/link.png'|url }}>
  </form>
  <h5><a href="{{entry|url}}">{{entry.path.split('/')[-1]}}</a>: {{entry.description}}</h5>
  {{ render_attachments(entry) }}
{% endfor %}

{% endif %}


{% endblock %}
